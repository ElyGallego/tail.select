/*! pytesNET/rat.select | @version 1.0.0 | @license MIT | @copyright pytesNET <info@pytes.net> */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define("rat.select",t):((e="undefined"!=typeof globalThis?globalThis:e||self).rat=e.rat||{},e.rat.select=t())}(this,(function(){"use strict";"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e,t){for(var i=Object(e),n=1;n<arguments.length;n++){var s=arguments[n];if(null!=s)for(var l in s)Object.prototype.hasOwnProperty.call(s,l)&&(i[l]=s[l])}return i}}),"function"!=typeof CustomEvent.constructor&&(CustomEvent.constructor=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:null};var i=document.createEvent("CustomEvent");return i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i});var e=function(){function e(t){this.strings=e[t]||e.en}return e.prototype._=function(e,t){var i=e in this.strings?this.strings[e]:e;return"function"==typeof i&&(i=i.apply(this,t)),void 0!==t&&t.length>0&&t.map((function(e,t){var n=new RegExp("\\["+t.toString()+"\\]","g");i=i.replace(n,e.toString())})),i},e.en={buttonAll:"All",buttonNone:"None",disabled:"This field is disabled",empty:"No options available",multiple:"Choose one or more options...",multipleCount:function(e){return"[0] "+(1===e?"option":"options")+" selected..."},multipleLimit:"No more options selectable",single:"Choose an option..."},e}(),t=function(){function e(e){this.plugins=e}return e.add=function(e,t,i){return!(e in this.plugins)&&(this.plugins[e]={config:t,hooks:i},!0)},e.prototype.hook=function(e){var t=[];for(var i in this.plugins)e in this.plugins[i].hooks&&t.push(this.plugins[i].hooks[e]);return t},e.plugins={},e}(),i=function(){function e(e){if(this.select=e,this.source=e.source,[].map.call(this.source.querySelectorAll("option:not([value])"),(function(e){""!==e.innerText&&e.setAttribute("value",e.innerText)})),e.get("deselect")&&!e.get("multiple")){var t=this.source.querySelector("option:checked");t&&null===this.source.querySelector("option[selected]")&&(t.selected=!1,this.source.selectedIndex=-1)}}return e.prototype.create=function(e,t){var i=document.createElement("OPTION");return i.value=e,i.innerText=t.title,i.selected=t.selected||!1,i.disabled=t.disabled||!1,i.hidden=t.hidden||!1,t.description&&(i.dataset.description=t.description),i},e.prototype.parse=function(e){for(var t in e){if("string"==typeof e[t])var i=this.create(t,Object({title:e[t]}));else i=this.create(t,e[t]);this.set(i)}return this},e.prototype.get=function(e,t,i){var n={disabled:":disabled",selected:":checked",hidden:"[hidden]"};t=""!==t&&t;var s=i?i.map((function(e){return"!"===e[0]?":not("+n[e.slice(1)]+")":n[e]})):"";if(s+=":not([data-rat-ignore])","number"==typeof e){s="option"+(e>0?":nth-child":":nth-last-child")+"("+Math.abs(e)+")"+s}else{if("string"!=typeof e&&e)return[];s="option"+(e?'[value="'+e+'"]':"")+s}return t||!1===t?"string"==typeof t?this.source.querySelectorAll('optgroup[label="'+t+'"] '+s):!1===t?(s='select[data-rat-select="'+this.source.dataset.ratSelect+'"] > '+s,this.source.parentElement.querySelectorAll(s)):[]:this.source.querySelectorAll(s)},e.prototype.getGroups=function(e){var t=this.source.querySelectorAll("optgroup");return e?t:[].map.call(t,(function(e){return e.label}))},e.prototype.count=function(e,t){if(0===arguments.length)return this.source.options.length;var i=this.get(null,e,t);return i?i.length:0},e.prototype.set=function(e,t,i,n){var s=this;if(!(e instanceof HTMLOptionElement))return[].map.call(e,(function(e,n){return s.set(e,t,i<0?-1:i+n,!1)})),n&&this.select.reload(),this;if(null==t&&(t=e.parentElement.label||!1),"string"==typeof t){var l=this.source.querySelector('optgroup[label="'+t+'"]');l||((l=document.createElement("OPTGROUP")).label=t,l.dataset.select="add",this.source.appendChild(l)),i<0||i>l.children.length?l.appendChild(e):l.insertBefore(e,l.children[i])}if(!t){var r='select[data-rat-select="'+this.source.dataset.ratSelect+'"] > option',o=this.source.parentElement.querySelectorAll(r),a=Math.min(i<0?o.length:i,o.length);this.source.children.length!==a&&o[a-1].nextElementSibling?this.source.insertBefore(e,o[a-1].nextElementSibling||this.source.children[0]):this.source.appendChild(e)}return e.dataset.select="add",n&&this.select.reload(),this},e.prototype.remove=function(e,t){return e instanceof HTMLOptionElement&&(e=[e]),[].map.call(e,(function(e){e.parentElement.removeChild(e)})),t&&this.select.reload,this},e.prototype.handle=function(e,t){var i=this;e instanceof HTMLOptionElement&&(e=[e]);var n=[],s=this.select.get("multiLimit",-1);return[].map.call(e,(function(e){var l={};for(t.hasOwnProperty("disabled")&&t.disabled!==e.disabled&&(l.disabled=e.disabled=!e.disabled),t.hasOwnProperty("hidden")&&t.hidden!==e.hidden&&(l.hidden=e.hidden=!e.hidden);t.hasOwnProperty("selected")&&t.selected!==e.selected&&!e.disabled&&!e.hidden&&!(!e.selected&&i.source.multiple&&s>=0&&s<=i.count(null,[":selected"]))&&(!e.selected||i.source.multiple||i.select.get("deselect",!1));){if(!i.source.multiple&&!e.selected&&i.source.selectedIndex>=0&&n.push([i.source.options[i.source.selectedIndex],{selected:!1}]),l.selected=e.selected=!e.selected,!i.source.multiple&&!e.selected){i.source.selectedIndex=i.source.querySelector('option[value=""]:not(:disabled):checked:first-child')?0:-1}break}Object.keys(l).length>0&&n.push([e,l])})),this.select.update(n),this},e.prototype.selected=function(e,t){return this.handle(e,{selected:t})},e.prototype.disabled=function(e,t){return this.handle(e,{disabled:t})},e.prototype.hidden=function(e,t){return this.handle(e,{hidden:t})},e}(),n=function(){function n(s,l,r){this.source=s,this.config=l,this.options=new(r||i)(this),this.locale=new e(l.locale||"en"),this.plugins=new t(l.plugins||{}),this.events=l.on||{},this.config.multiple=this.source.multiple=l.multiple||s.multiple,this.config.disabled=this.source.disabled=l.disabled||s.disabled,this.config.required=this.source.required=l.required||s.required,this.config.placeholder=l.placeholder||s.dataset.placeholder||null;var o=s.querySelector("option[value='']:checked:first-child");if(o&&(o.dataset.ratIgnore="1")&&(this.config.deselect=!o.disabled,this.config.placeholder=o.innerText||l.placeholder),null===(l.rtl||null)&&(this.config.rtl=["ar","fa","he","mdr","sam","syr"].indexOf(l.locale||"en")>=0),null===(l.theme||null)){var a=document.createElement("SPAN");a.className="rat-select-theme-name",document.body.appendChild(a),this.config.theme=window.getComputedStyle(a,":after").content.replace(/"/g,""),document.body.removeChild(a)}s.dataset.ratSelect=n.inst.length.toString(),n.inst[n.inst.length++]=this,this.init()}return n.prototype.init=function(){if(!1===this.trigger("hook","init:before"))return this;if(void 0!==this.config.items){var e=this.config.items;this.options.parse("function"==typeof e?e.call(this,this.options):e)}return!0===this.trigger("hook","build:before")&&(this.build(),this.trigger("hook","build:after")),!0===this.trigger("hook","bind:before")&&(this.bind(),this.trigger("hook","bind:after")),this.source.nextElementSibling?this.source.parentElement.insertBefore(this.select,this.source.nextElementSibling):this.source.parentElement.appendChild(this.select),this.updateLabel(),this.trigger("hook","init:after"),this.query()},n.prototype.build=function(){var e=this,t=!0===this.get("classNames")?this.source.className:this.get("classNames","");this.select=document.createElement("DIV"),this.select.className=function(t){return e.get("rtl")&&t.unshift("rtl"),e.get("hideSelected")&&t.unshift("hide-selected"),e.get("hideDisabled")&&t.unshift("hide-disabled"),e.get("hideHidden",!0)&&t.unshift("hide-hidden"),e.get("disabled")&&t.unshift("disabled"),e.get("required")&&t.unshift("required"),e.get("multiple")&&t.unshift("multiple"),e.get("deselect")&&t.unshift("deselect"),t.unshift("rat-select theme-"+e.get("theme").replace("-"," scheme-").replace("."," ")),t.filter((function(e){return e.length>0})).join(" ")}("string"==typeof t?t.split(" "):t),this.select.tabIndex=this.source.tabIndex||0,this.select.dataset.ratSelect=this.source.dataset.ratSelect;var i,n=this.get("width",250);return null!==n&&(this.select.style.width=n+(isNaN(n)?"":"px")),this.label=document.createElement("LABEL"),this.label.className="select-label",this.label.innerHTML='<span class="label-inner"></span>',this.dropdown=document.createElement("DIV"),this.dropdown.className="select-dropdown overflow-"+this.get("titleOverflow","clip"),this.dropdown.innerHTML='<div class="dropdown-inner"></div>',this.csv=document.createElement("INPUT"),this.csv.className="select-search",this.csv.name=(!0===(i=this.get("csvOutput",!1))&&(i=e.source.dataset.name||e.source.name||""),!1===i?"":i),this.select.appendChild(this.label),this.select.appendChild(this.dropdown),this.get("csvOutput")&&this.select.appendChild(this.csv),this},n.prototype.calculate=function(){var e=this,t=this.dropdown,i=function(i){var n,s,l=t.cloneNode(!0);if(l.classList.add("height"),e.select.appendChild(l),"string"==typeof i&&":"===i.charAt(0)){var r=null!==(s=null===(n=t.querySelector(".dropdown-option"))||void 0===n?void 0:n.offsetHeight)&&void 0!==s?s:50;l.style.maxHeight=r*parseInt(i.slice(1))+"px"}else l.style.maxHeight=i+(isNaN(i)?"":"px");return i=l.offsetHeight>i?i:l.offsetHeight,e.select.removeChild(l),i}(this.get("height",350)?this.get("height",350):"auto");return t.style.maxHeight=i+"px",this},n.prototype.bind=function(e){return this.handler||(this.handler=this.handle.bind(this)),e?(document.removeEventListener("keydown",this.handler),document.removeEventListener("click",this.handler),this.get("sourceBind")&&this.source.removeEventListener("change",this.handler),this):(document.addEventListener("keydown",this.handler),document.addEventListener("click",this.handler),this.get("sourceBind")&&this.source.addEventListener("change",this.handler),this)},n.prototype.handle=function(e){var t=e.target;if(e.type,"click"===e.type){if(t===this.label||this.label.contains(t))return this.toggle();if(!this.select.contains(t)&&!this.get("stayOpen"))return this.close();if(this.dropdown.contains(t)){for(;t&&this.dropdown.contains(t)&&!t.dataset.action;)t=t.parentElement;if(!t.classList.contains("disabled")&&t.dataset.action&&(t.dataset.value||t.dataset.group)){var i=this.options.get(t.dataset.value,t.dataset.group),n=t.dataset.action;if(this.options.selected(i,"toggle"===n?null:"select"===n),!this.get("stayOpen")&&!this.source.multiple)return this.close()}}}"change"===e.type&&CustomEvent},n.prototype.trigger=function(e,t,i){var n=this;if("event"===e){var s={bubbles:!1,cancelable:!0,detail:{args:i,select:this}},l=new CustomEvent("rat::"+t,s),r=this.select.dispatchEvent(l);if("change"===t){var o=new CustomEvent("input",s),a=new CustomEvent("change",s);this.source.dispatchEvent(o),this.source.dispatchEvent(a)}}var c=!0;return this.plugins.hook(t).concat(this.events[t]||[]).map((function(t){"filter"===e?i=t.apply(n,i):!1===n.handle.apply(n,i)&&(c=!1)})),"hook"===e?c:"filter"===e?i:r},n.prototype.query=function(e){var t,i=this;if(!1===this.trigger("hook","query:before"))return this;e="function"==typeof e?e:this.get("query",(function(){return i.options.get()}));for(var n=null,s=void 0,l=[],r=0,o=(e=this.trigger("filter","query",[e])[0]).call(this);r<o.length;r++){var a=o[r],c=a.parentElement instanceof HTMLOptGroupElement?a.parentElement.label:null;if(a=(t=this.trigger("filter","walk",[a,c]))[0],(c=t[1])!==s){if(!(l.length>0&&l[0].dataset.group===(c||""))){var u=a.parentElement instanceof HTMLOptGroupElement?a.parentElemnt:null;if(u||((u=document.createElement("OPTGROUP")).innerText=this.get("ungroupedLabel",null)),null===(n=this.render(u))){s=c;continue}if(!1===n)break;l.push(n)}if(null!==(n=this.render(a))){if(!1===n)break;l[0].appendChild(n),"scroll"===this.get("titleOverflow")&&function(e,t){var i=window.getComputedStyle(e),n=e.clientWidth-parseInt(i.paddingLeft)-parseInt(i.paddingRight)-17,s=e.querySelector(".option-title");if(s.scrollwidth>n){var l=n-s.scrollWidth-15;s.style.paddingLeft=Math.abs(l)+"px",e.style.textIndent=l+"px"}}(n)}}}var d=this.dropdown.querySelector(".dropdown-inner"),h=d.cloneNode();return l.map((function(e){return h.appendChild(e)})),this.dropdown.replaceChild(h,d),this.select.classList.contains("active")&&this.calculate(),this.trigger("hook","query:after"),this},n.prototype.render=function(e){var t,i=this,n=e.tagName.toUpperCase(),s=document.createElement("OPTION"===n?"LI":"OL");if("OPTION"===n)s.className="dropdown-option "+function(e){return((i.get("multiple")&&e.hasAttribute("selected")||e.selected?" selected":"")+(e.disabled?" disabled":"")+(e.hidden?" hidden":"")).trim()}(e),s.innerHTML='<span class="option-title">'+e.innerHTML+"</span>",s.dataset.group=(null===(t=e.parentElement)||void 0===t?void 0:t.label)||"",s.dataset.value=e.value,s.dataset.action="toggle",e.dataset.description&&(s.innerHTML+='<span clasS="option-description">'+e.dataset.description+"</span>");else if(s.className="dropdown-optgroup",s.innerHTML='<li class="optgroup-title">'+e.label+"</li>",s.dataset.group=e.label,this.get("multiple")&&this.get("multiSelectGroup",1))for(var l=0,r=["select-none","select-all"];l<r.length;l++){var o=r[l],a=document.createElement("BUTTON");a.dataset.action=o,a.innerHTML=this.locale._("select-all"===o?"buttonAll":"buttonNone"),s.querySelector(".optgroup-title").appendChild(a)}return this.trigger("filter","render#"+n,[s,e,n])[0]},n.prototype.update=function(e){var t=this;return 0===e.length||!0!==this.trigger("hook","update:before",[e])?this:(this.trigger("event","change",[e]),this.source.multiple&&this.get("multiLimit")>0&&this.options.count(null,["selected"])>=this.get("multiLimit")&&this.trigger("event","limit",[e]),[].map.call(e,(function(e){var i=e[0],n=e[1],s=i.value.replace(/('|\\)/g,"\\$1"),l=i.parentElement&&i.parentElement.label||"",r=t.dropdown.querySelector('li[data-value="'+s+'"][data-group="'+l+'"]');if(r)for(var o in n)r.classList[n[o]?"add":"remove"](o)})),this.trigger("hook","update:after",[e]),this.updateCSV().updateLabel())},n.prototype.updateCSV=function(){return this.get("csvOutput")&&(this.csv.value=this.trigger("filter","update#csv",[this.value("csv")])[0]),this},n.prototype.updateLabel=function(e){var t=this.value("array"),i=this.get("multiLimit");return e=this.source.disabled||!this.options.count()?this.source.disabled?"disabled":"empty":this.source.multiple&&t.length>0?i===t.length?"multipleLimit":"multipleCount":this.source.multiple||1!==t.length?this.get("placeholder")||(this.source.multiple?"multiple":"single"):t[0],this.label.innerText=this.locale._(e,[t.length]),this},n.prototype.open=function(){return this.select.classList.contains("active")||(this.calculate(),this.select.classList.add("active"),this.trigger("event","open",[])),this},n.prototype.close=function(){return this.select.classList.contains("active")?(this.dropdown.style.removeProperty("max-height"),this.select.classList.remove("active"),this.trigger("event","close",[]),this):this},n.prototype.toggle=function(){return this[this.select.classList.contains("active")?"close":"open"]()},n.prototype.reload=function(e){return this},n.prototype.remove=function(){return this},n.prototype.value=function(e){void 0!==e&&"auto"!==e||(e=this.source.multiple?"array":"csv");var t=this.options.get(null,null,["selected"]);switch(e){case"csv":return[].map.call(t,(function(e){return e.value})).join(this.get("csvSeparator",","));case"array":return[].map.call(t,(function(e){return e.value}));case"node":return this.source.multiple?[].map.call(t,(function(e){return e.value})):t[0]||null;default:return"array"===e?[]:null}},n.prototype.get=function(e,t){return e in this.config?this.config[e]:t},n.prototype.set=function(e,t,i){if(["multiple","disabled","required"].indexOf(e)>=0){if("disabled"===e)return this[t?"enable":"disable"](i);this.config[e]=this.source[e]=!!e}else this.config[e]=t;return i?this.reload():this},n.prototype.enable=function(e){return this.config.disabled=this.source.disabled=!1,this.select.classList.remove("disabled"),e?this.reload():this},n.prototype.disable=function(e){return this.config.disabled=this.source.disabled=!0,this.select.classList.add("disabled"),e?this.reload():this},n.prototype.on=function(e,t){var i=this;return e.split(",").map((function(e){i.events[e]=i.events[e]||[],i.events[e].push(t)})),this},n.inst={length:0},n}();function s(e,t,s){var l=function(e){return e instanceof HTMLSelectElement?e.dataset.ratSelect?n.inst[e.dataset.ratSelect]:new n(e,t?Object.assign({},t):{},s||i):null};return"string"==typeof e&&(e=document.querySelectorAll(e)),e instanceof HTMLSelectElement?l(e):[].map.call(e,l)}return s.version="1.0.0",s.status="stable",s.Select=n,s.Options=i,s.Strings=e,s.Plugins=t,s}));
/*! Visit this project on https://rat.md/select *///# sourceMappingURL=rat.select.min.js.map
