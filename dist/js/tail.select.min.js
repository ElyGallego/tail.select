/*! pytesNET/tail.select v0.6.0-beta | ECMAScript 5 | @copyright pytesNET <info@pytes.net> */
!function(t,i){"function"==typeof define&&define.amd?define("tail.select",[],function(){return i(t,t.document)}):"object"==typeof module&&module.exports?module.exports=function(t,e){return i(t,e||t.document)}:(void 0===t.tail&&(t.tail={}),t.tail.select=i(t,t.document),"undefined"!=typeof jQuery&&(jQuery.fn.tailselect=function(t,e){return this.map(function(){return tail.select(this,t,e)}).get()}),"undefined"!=typeof MooTools&&(Element.implement({tailselect:function(t,e){return tail.select(this,t,e)}}),Elements.implement({tailselect:function(t,e){return tail.select(this,t,e)}})))}("undefined"!=typeof window?window:"undefined"!=typeof global?global:this,function(v,m){"use strict";var b={trigger:function(t,e,i){if(CustomEvent&&CustomEvent.name){var s=new CustomEvent(e,i);return t.dispatchEvent(s)}var n=m.createEvent("CustomEvent");return n.initCustomEvent(e,!!i.bubbles,!!i.cancelable,i.detail),t.dispatchEvent(n)},clone:function(t,e){if("function"==typeof Object.assign)return Object.assign({},t,e||{});var i=new Object;for(var s in t)i[s]=t[s];for(var s in e)i[s]=e[s];return i},create:function(t,e){void 0===e&&(e=[]);var i=m.createElement(t);return i.className=Array.isArray(e)?e.join(" "):e||"",i}},t={en:{buttonAll:"All",buttonNone:"None",disabled:"This field is disabled",empty:"No options available",emptySearch:"No options found",multiple:"Choose one or more options...",multipleCount:"Choose up to [1] options...",multipleLimit:"No more options selectable...",multipleList:"[0] options selected",search:"Tap to search...",single:"Choose an option..."},add:function(t,e,i){return t in this||(this[t]=b.clone(this.en,{})),e instanceof Object?(this[t]=b.clone(this[t],e),!0):"string"==typeof e&&"string"==typeof i&&(this[t][e]=i,!0)}},i=function(){function Plugins(t,e){for(var i in this.self=e,this.active={},t)if(i in Plugins.plugins){var s=Plugins.plugins[i];e.set(b.clone(s.options,t[i])),this.active[i]=s}}return Plugins.prototype.callbacks=function(t){var e=[];for(var i in this.active)t in this.active[i].hooks&&e.push(this.active[i].hooks[t]);return e},Plugins.plugins={},Plugins.add=function(t,e,i){return!(t in this.plugins)&&(this.plugins[t]={hooks:i,options:e},!0)},Plugins}(),n=function(){function Options(t){if(this.__finderLoop=void 0,this.__walkerLoop=void 0,this.__walkerGroups=void 0,this.__walkerItems=void 0,this.parent=t,this.source=t.e,[].map.call(this.source.querySelectorAll("option:not([value])"),function(t){""!==t.innerText&&t.setAttribute("value",t.innerText)}),this.parent.get("deselect")&&!this.parent.get("multiple")){var e=this.source.querySelector("option:checked");null===this.source.querySelector("option[selected]")&&(e&&(e.selected=!1),this.source.selectedIndex=-1)}return this}return Options.prototype.create=function(t,e,i){var s=m.createElement("OPTION");if(s.setAttribute("value",t),s.innerText=e,void 0!==i&&i instanceof Object)for(var n in i)0<=["group","optgroup","position"].indexOf(n)||(0<=["disabled","selected","hidden"].indexOf(n)?s[n]=i[n]:s.setAttribute("description"===n?"data-description":n,i[n]));return s},Options.prototype.get=function(t,e,i,s,n){if(t instanceof Object)return t;var r=(n?"[hidden]":!1===n?":not([hidden])":"")+(i?":checked":!1===i?":not(:checked)":"")+(s?":disabled":!1===s?":not(:disabled)":"");if("number"==typeof t){var l;r="option"+(0<t?":nth-child":":nth-last-child")+"("+Math.abs(t)+")"+r}else{if("string"!=typeof t&&t)return[];r="option"+("string"==typeof t?'[value="'+t+'"]':"")+r}return e?"#"!==e?this.source.querySelectorAll('optgroup[label="'+e+'"] '+r):"#"===e?(r='select[data-tail-select="tail-'+this.parent.id+'"] > '+r,this.source.parentElement.querySelectorAll(r)):[]:this.source.querySelectorAll(r)},Options.prototype.getGroups=function(t){var e=this.source.querySelectorAll("optgroup");return t?e:[].map.call(e,function(t){return t.label})},Options.prototype.count=function(t,e,i,s){return 0===arguments.length?this.source.options.length:this.get(null,t||null,e,i,s).length},Options.prototype.set=function(t,i,s,e){var n=this;if(void 0===e&&(e=!0),!(t instanceof HTMLOptionElement))return t.forEach&&t.length&&0<t.length&&t.forEach(function(t,e){return n.set(t,i,s<0?-1:s+e,!1)}),e&&this.parent.reload(!0),this;null===i&&(i=t.parentElement.label||"#");var r=null,l=null;if("string"==typeof i&&"#"!==i){var o=this.source.querySelector("optgroup[label='"+i+"']");null===o&&((o=m.createElement("OPTGROUP")).setAttribute("label",i),o.setAttribute("data-select","add"),o.appendChild(t),this.source.appendChild(o),s=-1);var a=o.querySelectorAll("option");s<0||s>a.length?l=o:r=a[s]}else{var h='select[data-tail-select="tail-'+this.parent.id+'"] > option',a=this.source.parentElement.querySelectorAll(h),c=Math.min(s<0?a.length:s,a.length);this.source.children.length!==c&&a[c-1].nextElementSibling?r=a[c-1].nextElementSibling||this.source.children[0]:l=this.source}return null===t.parentElement&&t.setAttribute("data-select","add"),r?r.parentElement.insertBefore(t,r):(l||this.source).appendChild(t),e&&this.parent.reload(!0),this},Options.prototype.add=function(t,e,i){var s,n,r;for(var l in void 0===i&&(i=!0),t)"string"!=typeof t[l]?(n=t[l].optgroup||t[l].group||e||"#",r=t[l].position||-1,s=this.create(t[l].key||l,t[l].value||t[l].text,t[l]),this.set(s,n,r,!1)):this.set(this.create(l,t[l]),e||"#",-1,!1);return i&&this.parent.reload(!0),this},Options.prototype.handle=function(t,e,i,s){if(!(t instanceof HTMLOptionElement)){for(var n=this.get[t instanceof Array?"apply":"call"](this,t),r=[],l=void 0,o=0;o<n.length;o++)0<(l=this.handle(n[o],e,!0,s)).length&&(r=r.concat(l));return!i&&this.parent.update(r,!0,s),r}var a=this.parent.get.bind(this.parent),h=[],c={};for(e.hasOwnProperty("disabled")&&e.disabled!==t.disabled&&(t.disabled=null===e.disabled?!t.disabled:e.disabled,c.disabled=t.disabled),e.hasOwnProperty("hidden")&&e.hidden!==t.hidden&&(t.hidden=null===e.hidden?!t.hidden:e.hidden,c.hidden=t.hidden);e.hasOwnProperty("selected")&&(e.selected=null===e.selected?!t.selected:e.selected,!t.disabled&&!t.hidden&&t.selected!==e.selected||s)&&(!(e.selected&&a("multiple")&&a("multiLimit",1/0)<=this.count(null,!0))||s)&&(e.selected||a("multiple")||a("deselect")||s);){var u=this.source.options[this.source.selectedIndex];t.selected=e.selected,t[(e.selected?"set":"remove")+"Attribute"]("selected","selected"),c.selected=t.selected,e.selected&&!a("multiple")&&u?(u.selected=!1,u.removeAttribute("selected"),h.push([u,{selected:!1}])):e.selected||a("multiple")||!u||u!==t||(this.source.selectedIndex=-1);break}return 0<Object.keys(c).length&&h.push([t,c]),!i&&this.parent.update(h,!0,s),h},Options.prototype.select=function(t,e){return this.handle(t,{selected:!0},e)},Options.prototype.unselect=function(t,e){return this.handle(t,{selected:!1},e)},Options.prototype.disable=function(t,e){return this.handle(t,{disabled:!0},e)},Options.prototype.enable=function(t,e){return this.handle(t,{disabled:!1},e)},Options.prototype.hide=function(t,e){return this.handle(t,{hidden:!0},e)},Options.prototype.show=function(t,e){return this.handle(t,{hidden:!1},e)},Options.prototype.toggle=function(t,e,i){var s=((n={})[e]=null,n),n;return this.handle(t,s,i)},Options.prototype.reload=function(t,e){for(var i=this.parent.get("multiple")?this.parent.get("multiLimit"):1,s=this.source.querySelectorAll("option:checked").length,n=this.source.options,r=[],l=n.length-1;0<=l;l--){var o={},a=n[l].parentElement.label||"#",h='li[data-value="'+n[l].value+'"][data-group="'+a+'"]',c=this.parent._dropdown.querySelector(h);for(var u in{selected:"",disabled:"",hidden:""})c.classList.contains(u)!==n[l][u]&&(o[u]=n[l][u]);!e&&o.selected&&i<s&&(delete o.selected,n[l].selected=!1,s--),0<Object.keys(o).length&&r.push([n[l],o])}return 0===r.length?[]:(!t&&this.parent.update(r,!0,!1),r)},Options.prototype.applyLinguisticRules=function(t,e){var i=[],s=this.parent.get("linguisticRules",{});return Object.keys(s).forEach(function(t){return i.push("("+t+"|["+s[t]+"])")}),e&&(i=i.concat(i.map(function(t){return t.toUpperCase()}))),0===i.length?t:t.replace(new RegExp(i.join("|"),e?"g":"ig"),function(t){return i[[].indexOf.call(arguments,t,1)-1]})},Options.prototype.find=function(t,e,i){var s=this,n=this,r,l={};if("function"==typeof e?r=e.bind(this,t):e="string"==typeof e?[e]:e,e instanceof Array){e.forEach(function(t){"string"==typeof t&&(l[t]=!0)}),l.any=l.any?l.any:l.attributes&&l.value,l.regex&&!l.text||(t=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")),l.strict||(t=n.applyLinguisticRules.call(n,t,l.case)),l.word&&(t="\\b"+t+"\\b");var o=new RegExp(t,l.case?"m":"mi"),a=function(t){return o.test(t.innerText||t.value)};r=l.any?function(t){return a(t)||[].some.call(t.attributes,a)}:l.attributes?function(t){return[].some.call(t.attributes,a)}:a}var h=null===this.parent.get("hideDisabled")?"disabled":"",c=this.parent.get("hideEmpty",!0)?"value":"",u=null===this.parent.get("hideSelected")?"selected":"",d=null===this.parent.get("hideHidden",!0)?"hidden":"",p=[].filter.call(this.source.options,function(t){return!(t[h]||""===t[c]||t[u]||t[d])&&r.call(s,t)});return"ASC"===i?p=[].sort.call([].slice.call(p,0),function(t,e){return t.value>e.value}):"DESC"===i?p=[].sort.call([].slice.call(p,0),function(t,e){return t.value<e.value}):"function"==typeof i&&(p=i.call(this,p)),p},Options.prototype.finder=function(t,e,i){if("string"==typeof this&&"reset"===this)return delete t.__finderLoop,!1;var s;for(void 0===this.__finderLoop&&(this.__finderLoop=this.find(t,e,i));void 0!==(s=this.__finderLoop.shift());)return s;return this.finder.call("reset",this)},Options.prototype.walker=function(t,e){if("string"==typeof this&&"reset"===this)return delete t.__walkerLoop,delete t.__walkerGroups,delete t.__walkerItems,!1;if(void 0===this.__walkerLoop){var i=this.getGroups(!1)||[];"ASC"==t?i.sort():"DESC"==t?i.sort().reverse():"function"==typeof t&&(i=t.call(this,i)),i.unshift("#"),this.__walkerLoop=0,this.__walkerGroups=i,this.__walkerItems=[]}if(0<this.__walkerGroups.length&&this.__walkerItems.length===this.__walkerLoop){for(;0<this.__walkerGroups.length;){var s=this.get(null,this.__walkerGroups.shift());if(0<s.length)break}"ASC"===e?s=[].sort.call([].slice.call(s,0),function(t,e){return t.value>e.value}):"DESC"===e?s=[].sort.call([].slice.call(s,0),function(t,e){return t.value<e.value}):"function"==typeof e&&(s=e.call(this,s)),this.__walkerLoop=0,this.__walkerItems=s}if(this.__walkerLoop<this.__walkerItems.length){var n=null===this.parent.get("hideDisabled")?"disabled":"",r=this.parent.get("hideEmpty",!0)?"value":"",l=null===this.parent.get("hideSelected")?"selected":"",o=null===this.parent.get("hideHidden",!0)?"hidden":"",a=this.__walkerItems[this.__walkerLoop++];if(a)return a[n]||""===a[r]||a[l]||a[o]?this.walker(e,t):a}return this.walker.call("reset",this)},Options}(),e;return function(){function Select(t,e,i){var s;return(t="string"==typeof t?m.querySelectorAll(t):t)instanceof Element?t instanceof HTMLSelectElement&&this instanceof Select?Select.inst[t.getAttribute("data-tail-select")]?Select.inst[t.getAttribute("data-tail-select")]:(e=b.clone(e instanceof Object?e:{},{multiple:t.multiple,disabled:t.disabled,required:t.required,placeholder:t.getAttribute("data-placeholder")||(e||{}).placeholder}),this.id=++Select.count,(Select.inst["tail-"+this.id]=this).e=t,this.con=b.clone({},e),this.options=i||n,this.callbacks={},this.init()):t instanceof HTMLSelectElement?new Select(t,e,i):void 0:[].map.call(t,function(t){return new Select(t,e,i)}).filter(function(t){return"id"in t})}return Select.prototype._e=function(t,e){for(var i in t="function"==typeof(t=t in this.__?this.__[t]:t)?t.call(this,e):t,e||{})t=t.replace(i,e[i]);return t},Select.prototype._cls=function(t,e){var i;return(e+(this.get("multiple")&&t.hasAttribute("selected")||t.selected?" selected":"")+(t.disabled?" disabled":"")+(t.hidden?" hidden":"")).trim()},Select.prototype.init=function(){if(this.__=b.clone(Select.strings.en,Select.strings[this.get("locale",-1)]||{}),this.plugins=new i(this.get("plugins",{}),this),this.options instanceof n?this.options=new this.options.constructor(this):this.options=new this.options(this),this._spacing=1,this._last_query=["walker",[this.get("sortGroups"),this.get("sortItems")]],null===this.get("rtl")&&this.set("rtl",0<=["ar","fa","he","mdr","sam","syr"].indexOf(this.get("locale","en"))),!this.get("theme")){var t=b.create("SPAN","tail-select-theme-name");m.body.appendChild(t),this.set("theme",v.getComputedStyle(t,":after").content.replace(/"/g,"")),m.body.removeChild(t)}if(!0!==this.trigger("hook","init:before"))return this.get("startOpen")&&!this.get("disabled")?this.open():this;for(var e in this.build(this),this.e.setAttribute("data-tail-select","tail-"+this.id),this.get("items")instanceof Object&&this.options.add(this.get("items",{}),null,!1),this.get("on",{}))this.on(e,this.get("on",{})[e]);return void 0===this.listen&&(this.listen=function(t){this.bind.call(this,t)}.bind(this)),this.e.nextElementSibling?this.e.parentElement.insertBefore(this._select,this.e.nextElementSibling):this.e.parentElement.appendChild(this._select),this.get("sourceHide",!0)&&("none"===this.e.style.display?this._select.style.display="none":"hidden"===this.e.style.visibility?this._select.style.visibility="hidden":(this.e.style.display="none",this.e.setAttribute("data-tail-hidden","display"))),this.trigger("hook","init:after"),this.bind(this).query("walker",[this.get("sortGroups"),this.get("sortItems")]),this.get("startOpen")&&!this.get("disabled")?this.open():this},Select.prototype.build=function(t){if(!0!==this.trigger("hook","build:before"))return this;var e=!0===this.get("classNames")?this.e.className:this.get("classNames");return this._select=b.create("DIV",function(t){return this.get("rtl")&&t.unshift("rtl"),this.get("hideSelected")&&t.unshift("hide-selected"),this.get("hideDisabled")&&t.unshift("hide-disabled"),this.get("hideHidden",!0)&&t.unshift("hide-hidden"),this.get("disabled")&&t.unshift("disabled"),this.get("multiple")&&t.unshift("multiple"),this.get("deselect")&&t.unshift("deselectable"),t.unshift("tail-select theme-"+this.get("theme").replace("-"," scheme-").replace("."," ")),t}.call(this,[].concat(e?e.split?e.split(" "):e:[]))),this._select.setAttribute("tabindex",this.e.getAttribute("tabindex")||"0"),this.get("width",250)&&(this._select.style.width=this.get("width",250)+(isNaN(this.get("width",250))?"":"px")),this._label=b.create("DIV","select-label"),this._dropdown=b.create("DIV","select-dropdown title-"+this.get("titleOverflow","break")),this._search=b.create("DIV","dropdown-search"),this._search.innerHTML='<input type="text" class="search-input" />',this._search.children[0].setAttribute("placeholder",this._e("search")),this._csv=b.create("INPUT","select-search"),this._csv.type="hidden",this._csv.name=function(t){return!0===t&&!this.e.hasAttribute("data-name")&&(t=this.e.name)&&this.e.removeAttribute("name"),t.split?t:this.e.getAttribute("data-name")}.call(this,this.get("csvOutput",!1)),this._select.appendChild(this._label),this._select.appendChild(this._dropdown),this.get("search")&&this._dropdown.appendChild(this._search),this.get("csvOutput")&&this._select.appendChild(this._csv),this.trigger("hook","build:after"),this},Select.prototype.bind=function(t){if(!0!==this.trigger("hook","bind:before",[t]))return this;if(t instanceof Select?(m.addEventListener("keydown",this.listen),m.addEventListener("click",this.listen),this.get("search")&&this._search.children[0].addEventListener("input",this.listen),this.get("sourceBind")&&this.e.addEventListener("change",this.listen)):null===t&&(m.removeEventListener("keydown",this.listen),m.removeEventListener("click",this.listen),this._search.children[0].addEventListener("input",this.listen),this.e.removeEventListener("change",this.listen)),!(t instanceof Event)||this.get("disabled"))return this;var e=function(t){return t.preventDefault(),t.stopPropagation(),!0},i=t,s=i.target;if("click"===i.type&&s.getAttribute("for")===this.e.id)return this._select.focus(),e(i);if("input"===i.type&&s===this._search.children[0]){var n;if((n=s.value).length>=Math.max(this.get("searchMinLength",3),1))return this.query("finder",[n,this.get("searchConfig",["text","value"]),this.get("sortSearch")]);if(this._last_query[0]!==this.options.walker)return this.query("walker",[this.get("sortGroups"),this.get("sortItems")])}if("keydown"===i.type){var r=".dropdown-option:not(.disabled):not(.hidden)",l=i.keyCode||i.which,o=this._dropdown.querySelector(".dropdown-option.hover");switch(l+!!this._select.classList.contains("active")){case 32:if(this._select===m.activeElement)return!!e(i)&&this.open();default:if(!this._select.classList.contains("active"))return}switch(l){case 13:case 32+m.activeElement.tagName==="INPUT":if(e(i)&&o){var a=[o.getAttribute("data-value"),o.getAttribute("data-group")];this.options.toggle(a,"selected")}return!(!o||this.get("multiple")||this.get("stayOpen"))&&this.close();case 27:return!!e(i)&&this.close();case 38:case 40:var h=this._dropdown.querySelector(".dropdown-inner"),c=[].map.call(this._dropdown.querySelectorAll(r),function(t){return t}),u=null;if(o&&c[c.indexOf(o)+(40===l?1:-1)]&&(u=c[c.indexOf(o)+(40===l?1:-1)]),u||40!=l?u||38!=l||(u=c[c.length-1]):u=this._dropdown.querySelector(r),u){u&&u.classList.add("hover"),o&&o.classList.remove("hover");var d=function(t,e){for(;(t=t.parentElement)!=h;)e.top+=t.offsetTop;return e}(u,{top:u.offsetTop,height:u.offsetHeight});h.scrollTop=Math.max(0,d.top-2*d.height)}return e(i)}}if("click"===i.type){if(this._label.contains(s))return this.toggle();if(!this._select.contains(s)&&!0!==this.get("stayOpen"))return this.close();if(this._dropdown.contains(s)){var n=void 0,p=void 0,g=void 0;do{if(!s||s==m)return!1;n=s.getAttribute("data-value"),p=s.getAttribute("data-group"),g=s.getAttribute("data-action")}while((!g||!n&&!p)&&null!==(s=s.parentElement));if(g&&(n||p)){var f="toggle"===g?[[n,p],"selected"]:[[n,p]];if(this.options[g].apply(this.options,f),!this.get("stayOpen")&&this.options.count(null,!0)>=(this.get("multiple")?this.get("multiLimit"):1))return this.close()}}}return"change"===i.type&&void 0===i.detail?!!e(i)&&this.options.reload():(this.trigger("hook","bind:after",[t]),!0)},Select.prototype.calculate=function(){var n=this._dropdown,r=this._dropdown.querySelector(".dropdown-inner"),t=this._dropdown.contains(this._search)?this._search.clientHeight:0;if(!r)return this;var e=function(t){var e=n.cloneNode(!0);if(e.classList.add("cloned"),this._select.appendChild(e),"string"==typeof t&&":"===t.charAt(0)){var i=r.querySelector(".dropdown-option").offsetHeight,s=parseInt(v.getComputedStyle(r.querySelector("li:first-child")).marginTop);e.style.setProperty("max-height",i*parseInt(t.slice(1))+s+"px")}else e.style.setProperty("max-height",t+(isNaN(t)?"":"px"));return t=e.offsetHeight>t?t:e.offsetHeight,this._select.removeChild(e),t}.call(this,this.get("height",350)?this.get("height",350):"auto");"string"==typeof this.get("height")&&":"===this.get("height").charAt(0)&&(e+=t);var i=this._select.getBoundingClientRect(),s=i.x||i.top,l=v.innerHeight-(i.top+i.height),o=this.get("openAbove",null)||!(e<=l||s<=l);return e=Math.min(e,(o?s:l)-15),this._select.classList[o?"add":"remove"]("open-top"),this._dropdown.querySelector("li.optgroup-sticky")&&(this._spacing=this._dropdown.querySelector("li.optgroup-sticky").offsetHeight),n.style.maxHeight=e+"px",r.style.maxHeight=e-t+"px",this},Select.prototype.trigger=function(e,t,i){var s=this;if(void 0===i&&(i=[]),"event"===e){var n={bubbles:!1,cancelable:!0,detail:{args:i,self:this}};"change"===t&&(b.trigger(this.e,"input",n),b.trigger(this.e,"change",n)),b.trigger(this._select,"tail::"+t,n)}var r=!0;return this.plugins.callbacks(t).concat(this.callbacks[t]||[]).forEach(function(t){"filter"===e?i=t.apply(s,i):!1===t.apply(s,i)&&(r=!1)}),"filter"===e?i:r},Select.prototype.query=function(l,o){var s=this,t;if(!0!==this.trigger("hook","query:before",[l,o]))return this;t=this.trigger("filter","query",[l,o||[]]),l=t[0],o=t[1],"string"==typeof l&&(l=this.options[l in this.options?l:"walker"]);for(var a=[],h=null,c=null,e=function(t){var e,i=t.parentElement instanceof HTMLOptGroupElement&&t.parentElement.label||"#",n,s;if(t=(e=this.trigger("filter","query#walk",[t,i]))[0],i=e[1],c===i)return!0;if(!(0<a.length&&a[0].getAttribute("data-group")===i)){var r=t.parentElement instanceof HTMLOptGroupElement?t.parentElement:null;if(null===(h=this.render("group",r,[l,o])))return c=i,!0;if(!1===h)return!1;h.setAttribute("data-group",i),a.unshift(h)}return null===(h=this.render("item",t,[l,o]))||!1!==h&&(h.setAttribute("data-group",i),h.setAttribute("data-value",t.value||t.innerText),h.setAttribute("data-action","toggle"),a[0].appendChild(h),"scroll"===this.get("titleOverflow")&&(n=h,s=this,setTimeout(function(){var t=v.getComputedStyle(n),e=n.clientWidth-parseInt(t.paddingLeft)-parseInt(t.paddingRight)-17,i=n.querySelector(".option-title");if(i.scrollWidth>e){var s=e-i.scrollWidth-15;i.style.paddingLeft=Math.abs(s)+"px",n.style.textIndent=s+"px"}},150)),!0)}.bind(this),i;!1!==(i=l.apply(this.options,o));)if(!e(i)){l.call("reset",this.options);break}var n="li.dropdown-option[data-value]"+(this.get("hideHidden",1)?":not(.hidden)":"")+(this.get("hideDisabled")?":not(.disabled)":"")+(this.get("hideSelected")?":not(.selected)":""),r=b.create("DIV","dropdown-inner");r.addEventListener("scroll",function(t){for(var e=t.target.querySelectorAll("ul li.optgroup-sticky"),i=0;i<e.length;i++)e[i].offsetTop>s._spacing?e[i].classList.add("moving"):e[i].classList.contains("moving")&&e[i].classList.remove("moving")});for(var u=a.length-1;0<=u;u--)0<a[u].querySelectorAll(n).length&&r.appendChild(a[u]);if(""===r.innerText&&(h=this.render("empty",null,[l,o]))instanceof Element&&r.appendChild(h),this.trigger("event",(""===r.innerText?"no":"")+"results",[r,l,o]),""!==r.innerText&&this.get("multiple")&&this.get("multiSelectAll")){var d=b.create("SPAN","dropdown-action");for(var p in{"select-all":"","select-none":""}){var g=b.create("BUTTON",p);g.setAttribute("data-action","select-all"===p?"select":"unselect"),g.innerHTML=this._e("select-all"===p?"buttonAll":"buttonNone"),d.appendChild(g)}r.insertBefore(d,r.children[0])}var f=this._dropdown.querySelector(".dropdown-inner");return this._dropdown[(f?"replace":"append")+"Child"](this.trigger("filter","dropdown",[r])[0],f),this._select.classList.contains("active")&&this.calculate(),this._last_query=[l,o],this.trigger("hook","query:after",[l,o]),this.updateLabel().updateCSV()},Select.prototype.render=function(t,e,i){var s="",n=this.trigger("filter","render",[{item:function(t,e){var i=b.create("LI",this._cls(t,"dropdown-option"));if(e[0]===this.options.finder&&this.get("searchMarked",1)){var s=new RegExp("("+this.options.applyLinguisticRules(e[1][0])+")","i");i.innerHTML=t.innerHTML.replace(s,"<mark>$1</mark>")}else i.innerHTML=t.innerHTML;return i.innerHTML='<span class="option-title">'+i.innerHTML+"</span>",this.get("descriptions",1)&&t.hasAttribute("data-description")&&(i.innerHTML+='<span class="option-description">'+t.getAttribute("data-description")+"</span>"),i},group:function(t,e){var i=b.create("UL","dropdown-optgroup");if(!t&&!this.get("grouplessName"))return i;var s=t?t.label:"#",n=t?t.label:this.get("grouplessName");if(i.innerHTML='<li class="optgroup-title'+(this.get("stickyGroups")?" optgroup-sticky":"")+'"><b>'+n+"</b></li>",this.get("multiple")&&this.get("multiSelectGroup",1))for(var r in{"select-none":"","select-all":""}){var l=b.create("BUTTON",r);l.setAttribute("data-group",s),l.setAttribute("data-action","select-all"===r?"select":"unselect"),l.innerHTML=this._e("select-all"===r?"buttonAll":"buttonNone"),i.children[0].appendChild(l)}return i},empty:function(t,e){var i=b.create("SPAN","dropdown-empty");return i.innerHTML=this._e("empty"),i}}])[0];return this.trigger("filter","render#"+t,[n[t].apply(this,[e,i])])[0]},Select.prototype.update=function(t,e,i){var s;if(void 0===e&&(e=!0),0===t.length)return this;if(t=(s=this.trigger("filter","update",[t,e]))[0],e=s[1],!0!==this.trigger("hook","update:before",[t,e,i]))return this;e&&(this.trigger("event","change",[t,i]),this.e.querySelectorAll("option:checked")>=this.get("multiLimit",1/0)&&this.trigger("event","limit",[t,i]));for(var n=void 0,r=0;r<t.length;r++){var l,o,a="[data-value='"+t[r][0].value.replace(/('|\\)/g,"\\$1")+"'][data-group='"+(t[r][0].parentElement&&t[r][0].parentElement.label||"#")+"']";if(null!==(n=this._dropdown.querySelector(a))){var h=n.className.replace(/\b(selected|disabled|hidden)\b/gi,"").trim();n.className=this._cls(t[r][0],h.replace(/[ ]+/g," "))}}return this.updateCSV(),this.updateLabel(),this.trigger("hook","update:after",[t,e,i]),this},Select.prototype.updateCSV=function(){return this.get("csvOutput")&&(this._csv.value=this.trigger("filter","update#csv",[this.value("csv")])[0]),this},Select.prototype.updateLabel=function(t){var e,i,s=this.value("array"),n=this.get("multiLimit",1/0),r="",l={"[0]":s.length,"[1]":n===1/0?"&infin;":n,"[2]":n===1/0?this.options.count(null,!1,!1,!1):n-s.length};if(void 0===t){switch(!0){case this.get("disabled"):t="disabled";break;case 0===this.options.count():t="empty"+("finder"===this._last_query[0]?"Search":"");break;case this.get("multiple")&&n===1/0:t=0===s.length?"multiple":"multipleList";break;case this.get("multiple")&&n!==1/0:t=s.length===n?"multipleLimit":"multipleCount";break;case!this.get("multiple"):t=this.value("nodes")[0]&&this.value("nodes")[0].innerText||"single";break;default:t=this.get("multiple")?"multiple":"single"}0<=["multiple","multipleCount","multipleList","single"].indexOf(t)&&(t="string"==typeof this.get("placeholder")?this.get("placeholder"):t)}var o=this.get("multiple")?this.get("placeholderCount"):null;if(null!==o)switch(!0){case"count-up"===o:o="[0]";break;case"count-down"===o:o="[2]";break;case"limit"===o:o="[1]";break;case"both"===o:o="[0]/[1]";break;case"function"==typeof o:o=o.call(this,t,l);break;default:o=null}return"function"==typeof this.get("placeholder")&&(t=(e=this.get("placeholder").call(this,t,o,l))[0],o=e[1],l=e[2]),r=(i=this.trigger("filter","update#label",[r,t,o,l]))[0],t=i[1],o=i[2],l=i[3],""===r&&(r=(o?'<span class="label-count">'+this._e(o,l)+"</span>":"")+(t?'<span class="label-inner">'+this._e(t,l)+"</span>":"")),r instanceof HTMLElement&&r.classList.contains("select-label")?(this._select.replaceChild(r,this._label),this._label=r):this._label.innerHTML=r.innerHTML?r.innerHTML:r,this},Select.prototype.open=function(){return this._select.classList.contains("active")||(this.calculate(),this.trigger("event","open",[]),this._select.classList.add("active"),this.get("search")&&this.get("searchFocus",!0)&&this._search.querySelector("input").focus()),this},Select.prototype.close=function(){return this._select.classList.contains("active")&&(this.trigger("event","close",[]),this._select.classList.remove("active"),this._dropdown.style.removeProperty("max-height"),this._dropdown.querySelector(".dropdown-inner").style.removeProperty("max-height")),this},Select.prototype.toggle=function(){return this._select.classList.contains("active")?this.close():this.open()},Select.prototype.reload=function(t){return void 0===t&&(t=!0),!0!==this.trigger("hook","reload:before",[t])||(t?this.query.apply(this,this._last_query):this.remove().init(),this.trigger("hook","reload:after",[t])),this},Select.prototype.remove=function(t){return!0!==this.trigger("hook","remove:before",[t])||(this.bind(null),this.get("csvOutput")&&!this.e.hasAttribute("data-name")&&this.e.setAttribute("name",this._csv.name),void 0!==t&&!0===t||([].map.call(this.e.querySelectorAll("optgroup[data-select='add']"),function(t){t.parentElement.removeChild(t)}),[].map.call(this.e.querySelectorAll("option[data-select='add']"),function(t){t.parentElement.removeChild(t)})),this.e.hasAttribute("data-tail-hidden")&&(this.e.style.removeProperty(this.e.getAttribute("data-tail-hidden")),this.e.removeAttribute("data-tail-hidden")),this._select.parentElement&&this._select.parentElement.removeChild(this._select),this.e.removeAttribute("data-tail-select"),this.trigger("hook","remove:after",[t])),this},Select.prototype.get=function(t,e){return t in this.con?this.con[t]:e},Select.prototype.set=function(t,e){if("object"!=typeof t)return"disabled"===t?this[t?"disable":"enable"](!0):("multiple"===t&&(this.e.multiple=e),this.con[t]=e,this);for(var i in t)this.set(i,t[i]);return this},Select.prototype.enable=function(t){return this.trigger("event","enable",[t]),this._select.classList.remove("disabled"),this.con.disabled=this.e.disabled=!1,!0===t?this.reload():this},Select.prototype.disable=function(t){return this.trigger("event","disable",[t]),this._select.classList.add("disabled"),this.con.disabled=this.e.disabled=!0,!0===t?this.reload():this},Select.prototype.on=function(t,e){t="string"==typeof t?[t]:t;for(var i=0;i<t.length;i++)t[i]in this.callbacks||(this.callbacks[t[i]]=[]),this.callbacks[t[i]].push(e);return this},Select.prototype.value=function(t){void 0===t&&(t="auto");var e=this.options.get(null,null,!0);switch("auto"===t?this.get("multiple")?"array":"csv":t){case"csv":return[].map.call(e,function(t){return t.value}).join(this.get("csvSeparator",","));case"array":return[].map.call(e,function(t){return t.value});case"nodes":return e}return!1},Select.version="0.6.0",Select.status="beta",Select.__=b,Select.count=0,Select.inst={},Select.strings=t,Select.options=n,Select.plugins=i,Select}()});