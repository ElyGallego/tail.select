/*! pytesNET/rat.select | @version 1.0.0 | @license MIT | @copyright pytesNET <info@pytes.net> */
class e{constructor(t){this.strings=e[t]||e.en}_(e,t){let s=e in this.strings?this.strings[e]:e;return void 0!==typeof t&&t.length>0&&t.map(((e,t)=>{let i=new RegExp("["+t+"]","g");return s.replace(i,e)})),s}}e.en={key:"value"};class t{constructor(e){this.plugins=e}static add(e,t,s){return!(e in this.plugins)&&(this.plugins[e]={config:t,hooks:s},!0)}hook(e){let t=[];for(let s in this.plugins)e in this.plugins[s].hooks&&t.push(this.plugins[s].hooks[e]);return t}}t.plugins={};class s{constructor(e){if(this.select=e,this.source=e.source,[].map.call(this.source.querySelectorAll("option:not([value])"),(e=>{""!==e.innerText&&e.setAttribute("value",e.innerText)})),e.get("deselect")&&!e.get("multiple")){let e=this.source.querySelector("option:checked");e&&null===this.source.querySelector("option[selected]")&&(e.selected=!1,this.source.selectedIndex=-1)}}create(e,t){let s=document.createElement("OPTION");return s.value=e,s.innerText=t.title,s.selected=t.selected||!1,s.disabled=t.disabled||!1,s.hidden=t.hidden||!1,t.description&&(s.dataset.description=t.description),s}parse(e){for(let s in e){if("string"==typeof e[s])var t=this.create(s,Object({title:e[s]}));else t=this.create(s,e[s]);this.set(t)}return this}get(e,t,s){let i={disabled:":disabled",selected:":checked",hidden:"[hidden]"};t=""!==t&&t;let l=s?s.map((e=>"!"===e[0]?`:not(${i[e.slice(1)]})`:i[e])):"";if("number"==typeof e){l=`option${e>0?":nth-child":":nth-last-child"}(${Math.abs(e)})${l}`}else{if("string"!=typeof e&&e)return[];l=`option${e?`[value="${e}"]`:""}${l}`}return t||!1===t?"string"==typeof t?this.source.querySelectorAll(`optgroup[label="${t}"] ${l}`):!1===t?(l=`select[data-rat-select="${this.source.dataset.ratSelect}"] > ${l}`,this.source.parentElement.querySelectorAll(l)):[]:this.source.querySelectorAll(l)}getGroups(e){let t=this.source.querySelectorAll("optgroup");return e?t:[].map.call(t,(e=>e.label))}count(e,t){if(0===arguments.length)return this.source.options.length;let s=this.get(null,e,t);return s?s.length:0}set(e,t,s,i){if(!(e instanceof HTMLOptionElement))return[].map.call(e,((e,i)=>this.set(e,t,s<0?-1:s+i,!1))),i&&this.select.reload(),this;if(null==t&&(t=e.parentElement.label||!1),"string"==typeof t){let i=this.source.querySelector(`optgroup[label="${t}"]`);i||(i=document.createElement("OPTGROUP"),i.label=t,i.dataset.select="add",this.source.appendChild(i)),s<0||s>i.children.length?i.appendChild(e):i.insertBefore(e,i.children[s])}if(!t){let t=`select[data-rat-select="${this.source.dataset.ratSelect}"] > option`,i=this.source.parentElement.querySelectorAll(t),l=Math.min(s<0?i.length:s,i.length);this.source.children.length!==l&&i[l-1].nextElementSibling?this.source.insertBefore(e,i[l-1].nextElementSibling||this.source.children[0]):this.source.appendChild(e)}return e.dataset.select="add",i&&this.select.reload(),this}remove(e,t){return e instanceof HTMLOptionElement&&(e=[e]),[].map.call(e,(e=>{e.parentElement.removeChild(e)})),t&&this.select.reload,this}handle(e,t){e instanceof HTMLOptionElement&&(e=[e]);let s=[],i=this.select.get("multiLimit",-1);return[].map.call(e,(e=>{let l={};for(t.hasOwnProperty("disabled")&&t.disabled!==e.disabled&&(l.disabled=e.disabled=!e.disabled),t.hasOwnProperty("hidden")&&t.hidden!==e.hidden&&(l.hidden=e.hidden=!e.hidden);t.hasOwnProperty("selected")&&t.selected!==e.selected&&!e.disabled&&!e.hidden&&!(!e.selected&&this.source.multiple&&i>=0&&i<=this.count(null,[":selected"]))&&(!e.selected||this.source.multiple||!this.select.get("deselect",!1));){l.selected=e.selected=!e.selected,this.source.multiple||e.selected||(this.source.selectedIndex=-1);break}Object.keys(l).length>0&&s.push([e,l])})),this.select.update(s),this}selected(e,t){return this.handle(e,{selected:t})}disabled(e,t){return this.handle(e,{disabled:t})}hidden(e,t){return this.handle(e,{hidden:t})}}class i{constructor(l,n,r){this.source=l,this.config=n,this.options=new(r||s)(this),this.locale=new e(n.locale||"en"),this.plugins=new t(n.plugins||{}),this.events=n.on||{},this.config.multiple=this.source.multiple=n.multiple||l.multiple,this.config.disabled=this.source.disabled=n.disabled||l.disabled,this.config.required=this.source.required=n.required||l.required;let a=n.placeholder||l.dataset.placeholder||null;if(a&&""!==l.options[0].value||(a=l.options[0].innerText),this.config.placeholder=a,null===(n.rtl||null)&&(this.config.rtl=["ar","fa","he","mdr","sam","syr"].indexOf(n.locale||"en")>=0),null===(n.theme||null)){let e=document.createElement("SPAN");e.className="rat-select-theme-name",document.body.appendChild(e),this.config.theme=window.getComputedStyle(e,":after").content.replace(/"/g,""),document.body.removeChild(e)}l.dataset.ratSelect=i.inst.length.toString(),i.inst[i.inst.length++]=this,this.init()}init(){if(!1===this.trigger("hook","init:before"))return this;if(void 0!==this.config.items){let e=this.config.items;this.options.parse("function"==typeof e?e.call(this,this.options):e)}return!0===this.trigger("hook","build:before")&&(this.build(),this.trigger("hook","build:after")),!0===this.trigger("hook","bind:before")&&(this.bind(),this.trigger("hook","bind:after")),this.source.nextElementSibling?this.source.parentElement.insertBefore(this.select,this.source.nextElementSibling):this.source.parentElement.appendChild(this.select),this.trigger("hook","init:after"),this.query()}build(){let e=!0===this.get("classNames")?this.source.className:this.get("classNames","");this.select=document.createElement("DIV"),this.select.className=(e=>(this.get("rtl")&&e.unshift("rtl"),this.get("hideSelected")&&e.unshift("hide-selected"),this.get("hideDisabled")&&e.unshift("hide-disabled"),this.get("hideHidden",!0)&&e.unshift("hide-hidden"),this.get("disabled")&&e.unshift("disabled"),this.get("required")&&e.unshift("required"),this.get("multiple")&&e.unshift("multiple"),this.get("deselect")&&e.unshift("deselect"),e.unshift(`rat-select theme-${this.get("theme").replace("-"," scheme-").replace("."," ")}`),e.filter((e=>e.length>0)).join(" ")))("string"==typeof e?e.split(" "):e),this.select.tabIndex=this.source.tabIndex||0,this.select.dataset.ratSelect=this.source.dataset.ratSelect;let t=this.get("width",250);return null!==t&&(this.select.style.width=t+(isNaN(t)?"":"px")),this.label=document.createElement("LABEL"),this.label.className="select-label",this.label.innerHTML='<span class="label-inner">Test Placeholder</span>',this.dropdown=document.createElement("DIV"),this.dropdown.className=`select-dropdown overflow-${this.get("titleOverflow","clip")}`,this.dropdown.innerHTML='<div class="dropdown-inner"></div>',this.csv=document.createElement("INPUT"),this.csv.className="select-search",this.csv.name=(e=>(!0===e&&(e=this.source.dataset.name||this.source.name||""),!1===e?"":e))(this.get("csvOutput",!1)),this.select.appendChild(this.label),this.select.appendChild(this.dropdown),this.get("csvOutput")&&this.select.appendChild(this.csv),this}calculate(){let e=this.dropdown,t=(t=>{var s,i;let l=e.cloneNode(!0);if(l.classList.add("height"),this.select.appendChild(l),"string"==typeof t&&":"===t.charAt(0)){let n=null!==(i=null===(s=e.querySelector(".dropdown-option"))||void 0===s?void 0:s.offsetHeight)&&void 0!==i?i:50;l.style.maxHeight=n*parseInt(t.slice(1))+"px"}else l.style.maxHeight=t+(isNaN(t)?"":"px");return t=l.offsetHeight>t?t:l.offsetHeight,this.select.removeChild(l),t})(this.get("height",350)?this.get("height",350):"auto");return e.style.maxHeight=t+"px",this}bind(){let e=this.handle.bind(this);return document.addEventListener("keydown",e),document.addEventListener("click",e),this.get("sourceBind")&&this.source.addEventListener("change",e),this}handle(e){let t=e.target;if("click"===e.type){if(t===this.label||this.label.contains(t))return this.toggle();if(!this.select.contains(t)&&!this.get("stayOpen"))return this.close();if(this.dropdown.contains(t)){for(;t&&this.dropdown.contains(t)&&!t.dataset.action;)t=t.parentElement;if(t.dataset.action&&(t.dataset.value||t.dataset.group)){let e=this.options.get(t.dataset.value,t.dataset.group),s=t.dataset.action;this.options.selected(e,"toggle"===s?null:"select"===s)}if(!this.get("stayOpen")&&!this.source.multiple)return this.close()}}}trigger(e,t,s){if("event"===e){let e={bubbles:!1,cancelable:!0,detail:{args:s,select:this}},l=new CustomEvent(`rat::${t}`,e);var i=this.select.dispatchEvent(l);if("change"===t){let t=new CustomEvent("input",e),s=new CustomEvent("change",e);this.source.dispatchEvent(t),this.source.dispatchEvent(s)}}let l=!0;return this.plugins.hook(t).concat(this.events[t]||[]).map((t=>{"filter"===e?s=t.apply(this,s):!1===this.handle.apply(this,s)&&(l=!1)})),"hook"===e?l:"filter"===e?s:i}query(e){if(!1===this.trigger("hook","query:before"))return this;e="function"==typeof e?e:this.get("query",(()=>this.options.get()));let t,s=null,i=[],l=(e=this.trigger("filter","query",[e])[0]).call(this);for(let e of l){let l=e.parentElement instanceof HTMLOptGroupElement?e.parentElement.label:null;if([e,l]=this.trigger("filter","walk",[e,l]),l!==t){if(!(i.length>0&&i[0].dataset.group===(l||""))){let n=e.parentElement instanceof HTMLOptGroupElement?e.parentElemnt:null;if(n||(n=document.createElement("OPTGROUP"),n.innerText=this.get("ungroupedLabel",null)),null===(s=this.render(n))){t=l;continue}if(!1===s)break;i.push(s)}if(null!==(s=this.render(e))){if(!1===s)break;i[0].appendChild(s),"scroll"===this.get("titleOverflow")&&function(e,t){let s=window.getComputedStyle(e),i=e.clientWidth-parseInt(s.paddingLeft)-parseInt(s.paddingRight)-17,l=e.querySelector(".option-title");if(l.scrollwidth>i){let t=i-l.scrollWidth-15;l.style.paddingLeft=Math.abs(t)+"px",e.style.textIndent=t+"px"}}(s)}}}let n=this.dropdown.querySelector(".dropdown-inner"),r=n.cloneNode();return i.map((e=>r.appendChild(e))),this.dropdown.replaceChild(r,n),this.select.classList.contains("active")&&this.calculate(),this.trigger("hook","query:after"),this}render(e){var t;let s=e.tagName.toUpperCase(),i=document.createElement("OPTION"===s?"LI":"OL");if("OPTION"===s)i.className="dropdown-option",i.innerHTML=`<span class="option-title">${e.innerHTML}</span>`,i.dataset.group=(null===(t=e.parentElement)||void 0===t?void 0:t.label)||"",i.dataset.value=e.value,i.dataset.action="toggle",e.dataset.description&&(i.innerHTML+=`<span clasS="option-description">${e.dataset.description}</span>`);else if(i.className="dropdown-optgroup",i.innerHTML=`<li class="optgroup-title">${e.label}</li>`,i.dataset.group=e.label,this.get("multiple")&&this.get("multiSelectGroup",1))for(let e of["select-none","select-all"]){let t=document.createElement("BUTTON");t.dataset.action=e,t.innerHTML=this.locale._("select-all"===e?"buttonAll":"buttonNone"),i.querySelector(".optgroup-title").appendChild(t)}return this.trigger("filter",`render#${s}`,[i,e,s])[0]}update(e){return this}open(){return this.select.classList.contains("active")||(this.calculate(),this.select.classList.add("active"),this.trigger("event","open",[])),this}close(){return this.select.classList.contains("active")?(this.dropdown.style.removeProperty("max-height"),this.select.classList.remove("active"),this.trigger("event","close",[]),this):this}toggle(){return this[this.select.classList.contains("active")?"close":"open"]()}reload(e){return this}remove(){return this}value(e){switch(void 0!==e&&"auto"!==e||(e=this.source.multiple?"array":"csv"),e){case"csv":case"array":case"node":default:return null}}get(e,t){return e in this.config?this.config[e]:t}set(e,t,s){if(["multiple","disabled","required"].indexOf(e)>=0){if("disabled"===e)return this[t?"enable":"disable"](s);this.config[e]=this.source[e]=!!e}else this.config[e]=t;return s?this.reload():this}enable(e){return this.config.disabled=this.source.disabled=!1,this.select.classList.remove("disabled"),e?this.reload():this}disable(e){return this.config.disabled=this.source.disabled=!0,this.select.classList.add("disabled"),e?this.reload():this}on(e,t){return e.split(",").map((e=>{this.events[e]=this.events[e]||[],this.events[e].push(t)})),this}}function l(e,t,l){let n=e=>e instanceof HTMLSelectElement?e.dataset.ratSelect?i.inst[e.dataset.ratSelect]:new i(e,t?Object.assign({},t):{},l||s):null;return"string"==typeof e&&(e=document.querySelectorAll(e)),e instanceof HTMLSelectElement?n(e):[].map.call(e,n)}i.inst={length:0},l.version="1.0.0",l.status="stable",l.Select=i,l.Options=s,l.Strings=e,l.Plugins=t;export default l;
/*! Visit this project on https://rat.md/select *///# sourceMappingURL=rat.select.min.js.map
