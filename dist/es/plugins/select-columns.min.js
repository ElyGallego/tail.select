/*! pytesNET/tail.select v{{ $data.version }}-beta | {{ $build }} | @copyright pytesNET <info@pytes.net> */
export function plugin(t){"use strict";var e={columns:1,groupCollapse:!1},l={"init:after":function(){let t=this.get("columns");return this.set("columns",t<1?1:t>5?5:t),!0},"bind:after":function(t){return!this.get("groupCollapse")||("click"===t.type&&t.target.classList.contains("optgroup-collapse")&&this.collapse(t.target.parentElement.parentElement),!0)},"query:after":function(){if(!this.get("groupCollapse"))return!0;let t=this._dropdown.querySelectorAll("ul");for(var e=0;e<t.length;e++)t[e].style.maxHeight=t[e].offsetHeight+"px";return!0},"render#group":function(e){if(this.get("groupCollapse")&&e.querySelector("li.optgroup-title")){let l=t.__.create("SPAN","optgroup-collapse");l.setAttribute("data-collapse","true"),e.querySelector("li.optgroup-title").appendChild(l)}return[e]},dropdown:function(e){if(this.get("columns")<=1)return[e];let l=e.querySelectorAll("li"),o=parseInt(this.get("columns")),r=".".repeat(o-1).split(".").map(()=>t.__.create("DIV","inner-column")),n=l.length+(o-1),i=-1,s=null;for(let t=0,e=0;e<l.length;t++,e++){let p=Math.max(Math.floor(t/Math.ceil(n/o)),i);if((p=Math.min(p,o-1))!==i||l[e].classList.contains("optgroup-title")||!s){if(!s||l[e].classList.contains("optgroup-title")){let t=l[e].parentElement.getAttribute("data-group"),o=this.e.querySelector(`optgroup[label='${t}']`);s=this.render("group",o,null)}else{let e=s.cloneNode();if(s.querySelector(".optgroup-title b")){let t=s.querySelector(".optgroup-title").cloneNode(!0);t.querySelector("b").innerText+=` (${this._e("continue")})`,e.appendChild(t)}s=e,t++}let u=Math.floor((t+1)/Math.ceil(n/o));u>p&&u<o?(t++,i=p=u):i=p,r[p].appendChild(s)}l[e].classList.contains("optgroup-title")||s.appendChild(l[e])}e.innerHTML="",e.classList.add("dropdown-columns"),e.classList.add("columns-"+this.get("columns"));for(let t=0;t<r.length;t++)e.appendChild(r[t]);return[e]}};return t.plugins.add("columns",e,l),t.strings.en.continue="Continue",t.prototype.collapse=function(t){return"string"==typeof t&&(t=this._dropdown.querySelector(`ul[data-group='${t}']`)),t instanceof HTMLElement&&t.classList.toggle("collapsed"),this},t};