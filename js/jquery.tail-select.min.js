/*
 *	TAIL.SELECT 0.2.0
 *	Copyright © 2014 - 2015 SamBrishes and pytesNET.
 *	Released under the MIT license.
 */
(function(){function c(){var b=this;this.data={},this.count=0,this.tail="data-tail",this.select="data-select",this.options={single_deselect:!1,multi_limit:0,multi_show_count:!0,multi_hide_selected:!0,multi_move_to:"",width:"",height:"200px",copy_class:!1,description:!1,hide_disabled:!1,hide_on_mobile:!0,hide_on_unsupported:!0,text_empty:"No options available...",text_limit:"You can't select more options!",text_placeholder:"Select an option..."},this.mobile=this.browser(!0),this.supported=this.browser(!1),a(document).bind("mousedown keydown",function(c){"keydown"==c.type&&27==c.keyCode&&a("div.tailms-select.tailms-status-open").length>0&&b.change_status(a("div.tailms-select.tailms-status-open").attr(b.tail),"close"),"mousedown"==c.type&&!a(c.target).closest("div.tailms-select").length&&a("div.tailms-select.tailms-status-open").length>0&&b.change_status(a("div.tailms-select.tailms-status-open").attr(b.tail),"close")})}var a,b;c.prototype.browser=function(a){if(a!==!0){if(-1!==navigator.appVersion.search(/MSIE /)){var c=navigator.appVersion.length,d=navigator.appVersion.search(/MSIE /),e=navigator.appVersion.slice(d,c).replace(/MSIE /,"");if(e=e.split("."),e=1*e[0],isNaN(e)===!1&&e>=8)return!0}if(-1!==navigator.userAgent.search(/MSIE /)){var c=navigator.userAgent.length,d=navigator.userAgent.search(/MSIE /),e=navigator.userAgent.slice(d,c).replace(/MSIE /,"");if(e=e.split("."),e=1*e[0],isNaN(e)===!1&&e>=8)return!0}if(-1!==navigator.userAgent.search(/OPR\//)){var c=navigator.userAgent.length,d=navigator.userAgent.search(/OPR\//),e=navigator.userAgent.slice(d,c).replace(/OPR\//,"");if(e=e.split("."),e=1*e[0],isNaN(e)===!1&&e>=15)return!0}if(-1!==navigator.userAgent.search(/Firefox\//)){var c=navigator.userAgent.length,d=navigator.userAgent.search(/Firefox\//),e=navigator.userAgent.slice(d,c).replace(/Firefox\//,"");if(e=e.split("."),e=1*e[0],isNaN(e)===!1&&e>=5)return!0}if(-1!==navigator.userAgent.search(/Chrome\//)){var c=navigator.userAgent.length,d=navigator.userAgent.search(/Chrome\//),e=navigator.userAgent.slice(d,c).replace(/Chrome\//,"");if(e=e.split("."),e=1*e[0],isNaN(e)===!1&&e>=17)return!0}return!1}try{return document.createEvent("TouchEvent"),!0}catch(b){return!1}},c.prototype.register=function(b,c){if("undefined"!==typeof a(b).attr(this.select)||!a(b).is("select"))return!1;var d="select_"+this.count,e=a.extend({multiple:!1},this.options);for(var f in e)"undefined"!==typeof c&&c.hasOwnProperty(f)&&typeof c.key===typeof e.key&&(e[f]=c[f]);if("undefined"!==typeof a(b).attr("data-placeholder")&&(e.text_placeholder=a(b).attr("data-placeholder")),"undefined"!==typeof a.prop?("multiple"===a(b).prop("multiple")||a(b).prop("multiple")===!0)&&(e.multiple=!0):("multiple"===a(b).attr("multiple")||a(b).attr("multiple")===!0||"string"===typeof a(b).attr("multiple"))&&(e.multiple=!0),e.hide_on_mobile===!0&&this.mobile===!0)return!1;if(e.hide_on_unsupported===!0&&this.supported===!1)return!1;a(b).attr(this.select,d),a(b).hide();var g={};return g[d]={selector:a("select["+this.select+"='"+d+"']"),options:e,objects:{},items:{}},a.extend(this.data,g),this.count++,this.create(d),this.bind(d),g[d].selector.trigger("tailSelect:ready",[d,g[d].selector,g[d]]),g[d].selector},c.prototype.create=function(b){var c=this.data[b],d=c.options;return c.objects.select=a("<div />"),c.objects.select.attr(this.tail,b),c.objects.select.addClass("tailms-select"),d.copy_class===!0&&c.objects.select.addClass(c.selector.attr("class")),d.description===!0&&c.objects.select.addClass("tailms-with-descriptions"),c.objects.select.addClass(1==d.multiple?"tailms-multiple":"tailms-single"),0==d.multiple&&d.single_deselect===!0&&c.objects.select.addClass("tailms-allow-deselect"),"undefined"===typeof trim?""!==d.width.replace(/^\s+|\s+$/g,"")&&c.objects.select.css("width",d.width):d.width.trim()!==!1&&c.objects.select.css("width",d.width),c.objects.container=a("<div />"),c.objects.container.addClass("tailms-option-container"),c.objects.container.prepend(a("<ul />",{"class":"tailms-active-list"})).hide(),c.objects.input=a("<div />"),c.objects.input.addClass("tailms-input"),c.objects.list=a("<ul />"),c.objects.list.addClass("tailms-option-list").hide(),c.objects.list.css("height","auto"),c.objects.list.css("max-height","0px"),c.objects.placeholder=a("<span />").addClass("tailms-input-placeholder"),c.objects.placeholder.text(d.text_placeholder),d.multiple===!0&&d.multi_show_count===!0&&(c.objects.placeholder.text(0===d.multi_limit?"(0) "+d.text_placeholder:"(0/"+d.multi_limit+") "+d.text_placeholder),c.objects.text),c.objects.puller=a("<span />"),c.objects.puller.addClass("tailms-input-puller"),c.objects.list.prependTo(c.objects.input),c.objects.placeholder.prependTo(c.objects.input),c.objects.puller.prependTo(c.objects.input),c.objects.input.prependTo(c.objects.select),c.objects.container.prependTo(c.objects.select),a(c.selector).after(c.objects.select),this.reload(b)},c.prototype.reload=function(b){for(var c=this.data[b],d=a(c.selector).clone(),e={},f=0;f<a(d).find("option").length;f++){var g=a(d).find("option").eq(f),h=!1;e[f]={label:"",value:"",group:!1,number:f,description:"",selected:!1,disabled:!1},e[f].label=a(g).text(),e[f].value="undefined"!==typeof a(g).attr("value")?a(g).attr("value").replace(/"/g,"").replace(/'/g,""):e[f].label.replace(/"/g,"").replace(/'/g,""),a(c.selector).find("option").eq(f).attr("data-option",f),a(g).parent().is("optgroup")&&"undefined"!==typeof a(g).parent().attr("label")&&(e[f].group=a(g).parent().attr("label")),"undefined"!==typeof a(g).attr("data-description")&&(e[f].description=a(g).attr("data-description").replace(/"/g,"").replace(/'/g,"")),("undefined"!==typeof a.prop&&a(g).prop("disabled")===!0||a(g).attr("disabled")===!0)&&(e[f].disabled=!0),("undefined"!==typeof a.prop&&(a(g).prop("selected")===!0||a(c.selector).val()==a(g).attr("value"))||a(g).attr("selected")===!0)&&(0==c.options.multiple?(0==h?e[f].selected=!0:a(c.selector).find("option").eq(f).removeAttr("selected"),h=!0):e[f].selected=!0)}return c.items=e,a.isEmptyObject(e)?this.action_empty(b):this.render_list(b,e)},c.prototype.render_list=function(b,c){var d=this.data[b],e=a(d.objects.list);a(e).children("li").length>0&&a(e).children("li").remove();var f="",g="";a.each(c,function(){var c=a("<li />").addClass("tailms-option");c.attr("data-value",this.value),c.attr("data-number",this.number),c.attr("data-disabled","false"),c.attr("data-selected","false");var h=a("<span />").addClass("tailms-option-label");if(h.text(this.label).appendTo(c),d.options.description===!0&&""!==this.description){var i=a("<span />").addClass("tailms-description");i.text(this.description).appendTo(c)}if(this.group!==!1){if(this.group!==f){var j=a("<li />").addClass("tailms-optgroup");j.attr("data-label",this.group);var k=a("<span />").addClass("tailms-optgroup-label");k.text(this.group).appendTo(j),g=a("<ul />").addClass("tailms-option-sublist"),g.appendTo(j),f=this.group,a(e).append(j)}a(g).append(c)}else a(e).append(c)});var h=this;a.each(c,function(){var d=a(e).find("li[data-number="+this.number+"]");this.disabled===!0&&h.action_disable(b,d),this.selected===!0&&h.action_select(b,d)})},c.prototype.bind=function(b){var c=this,d=this.data[b];a(d.objects.input).bind("mousedown",{id:b},function(b){1===b.which&&a(b.target).is("div.tailms-input, span.tailms-input-placeholder, span.tailms-input-puller")&&(b.preventDefault(),c.change_status(b.data.id,"open",!1))}),a(d.objects.list).find("li.tailms-option").bind("click",{id:b},function(a){a.preventDefault(),c.change_status(a.data.id,"select",this)}),"container"===d.options.multi_move_to&&a(d.objects.container).find(".tailms-deselect").bind("click",{id:b},function(a){a.preventDefault(),c.change_status(a.data.id,"deselect",this)}),"object"===typeof a.event.special.mousewheel&&a(d.objects.list).bind("mousewheel",function(b,c){var d=a(this).height(),e=a(this).get(0).scrollHeight;(this.scrollTop===e-d&&c<0||0===this.scrollTop&&c>0)&&b.preventDefault()})},c.prototype.change_status=function(b,c,d){var e=this.data[b];if("open"==c)if(a(e.objects.select).hasClass("tailms-status-open"))a(e.objects.list).css("max-height","0px"),a(e.objects.list).hide(),a(e.objects.select).removeClass("tailms-status-open");else{a(".tailms-select").hasClass("tailms-status-open")&&(a(".tailms-select").find(".tailms-option-list").css("max-height","0px"),a(".tailms-select").find(".tailms-option-list").hide(),a(".tailms-select").removeClass("tailms-status-open"));var f="",g="200px";if("undefined"===typeof trim){if(""!==e.options.height.replace(/^\s+|\s+$/g,""))var g=e.options.height.split("")}else if(e.options.height.trim()!==!1)var g=e.options.height.split("");for(var h=0;h<g.length;h++){var i=g[h];isNaN(i)||(f+=i)}f=1*f;var j=a(e.objects.input).offset().top+a(e.objects.input).outerHeight()+f,k=a(window).height()+a(window).scrollTop()-20;k<=j?a(e.objects.list).hasClass("tailms-view-top")||a(e.objects.list).addClass("tailms-view-top"):a(e.objects.list).hasClass("tailms-view-top")&&a(e.objects.list).removeClass("tailms-view-top"),a(e.objects.list).css("max-height",g.join("")),a(e.objects.list).show(),a(e.objects.select).addClass("tailms-status-open")}"close"==c&&(a(e.objects.list).css("max-height","0px"),a(e.objects.list).hide(),a(e.objects.select).removeClass("tailms-status-open")),"select"==c&&("false"==a(d).attr("data-selected")?this.action_select(b,d):(e.options.multiple!==!1||e.options.single_deselect!==!1)&&this.action_deselect(b,d)),"deselect"==c&&this.action_deselect(b,d)},c.prototype.action_select=function(b,c){if(!this.is_limit(b)&&"true"!==a(c).attr("data-disabled")&&"true"!==a(c).attr("data-selected")){var d=this.data[b],e=this;d.options.multiple===!1&&a(d.objects.list).find("li[data-selected='true']").length>0&&a.each(a(d.objects.list).find("li[data-selected='true']"),function(c){e.action_deselect(b,a(this).eq(c))});var f=a(d.selector).find("option[data-option='"+a(c).attr("data-number")+"']");if("undefined"!==typeof a.prop&&a(f).prop("selected",!0),a(f).attr("selected",!0),a(f).attr("selected","selected"),a(c).addClass("tailms-selected").attr("data-selected","true"),d.options.multiple===!0&&("top"===d.options.multi_move_to||"container"===d.options.multi_move_to)){var g=a("<li />").addClass("tailms-option-dummy");if(g.attr("data-holder",a(c).attr("data-number")),g.hide().insertAfter(a(c)),a(c).parent("ul").parent("li.tailms-optgroup").length>0){if(d.options.hide_disabled===!0)var h=a(c).parent("ul").children("li[data-selected='false'][data-disabled='false']").length;else var h=a(c).parent("ul").children("li[data-selected='false']").length;0==h&&a(c).parent("ul").parent(".tailms-optgroup").hide()}"top"===d.options.multi_move_to&&a(c).prependTo(a(d.objects.list)),"container"===d.options.multi_move_to&&("none"==a(d.objects.container).css("display")&&a(d.objects.container).show(),a(c).append(a("<span />",{"class":"tailms-close"})).appendTo(a(d.objects.container).children("ul.tailms-active-list")))}this.action_empty(b),this.action_placeholder(b,c),a(d.selector).trigger("tailSelect:change",[a(c),"selected",a(f)])}},c.prototype.action_deselect=function(b,c){if("true"!==a(c).attr("data-disabled")&&"false"!==a(c).attr("data-selected")){var d=this.data[b];if(d.options.multiple===!0&&("top"===d.options.multi_move_to||"container"===d.options.multi_move_to)){var e=a(d.objects.list).find("li[data-holder='"+a(c).attr("data-number")+"']");a(e).parent("ul").parent("li.tailms-optgroup").length>0&&"none"===a(e).parent("ul").parent("li.tailms-optgroup").css("display")&&a(e).parent("ul").parent("li.tailms-optgroup").show(),a(c).insertAfter(a(e)),a(e).remove(),"container"===d.options.multi_move_to&&(a(c).children("span.tailms-close").remove(),0==a(d.objects.container).find("li").length&&a(d.objects.container).hide())}var f=a(d.selector).find("option[data-option='"+a(c).attr("data-number")+"']");"undefined"!==typeof a.prop&&a(f).prop("selected",!1),a(f).removeAttr("selected"),a(c).removeClass("tailms-selected"),a(c).attr("data-selected","false"),d.options.multiple===!1&&0==a(d.selector).find("option[selected='selected']").length&&(a(d.selector).selectedIndex=-1,a(d.selector).val([])),this.action_empty(b),this.action_placeholder(b,c),a(d.selector).trigger("tailSelect:change",[a(c),"deselected",a(f)])}},c.prototype.action_enable=function(b,c){if("false"!==a(c).attr("data-disabled")){var d=this.data[b],e=a(d.selector).find("option[data-option='"+a(c).attr("data-number")+"']");a(e).removeAttr("disabled"),a(c).removeClass("tailms-disabled"),a(c).attr("data-disabled","false"),a(c).parent("ul").parent("li.tailms-optgroup").length>0&&"none"===a(c).parent("ul").parent("li.tailms-optgroup").css("display")&&a(c).parent("ul").parent("li.tailms-optgroup").show(),d.options.hide_disabled===!0&&a(c).show(),this.action_empty(b),this.action_placeholder(b,c),a(d.selector).trigger("tailSelect:change",[a(c),"enabled",a(e)])}},c.prototype.action_disable=function(b,c){if("undefined"!==typeof a(c).attr("data-number")&&"true"!==a(c).attr("data-disabled")){var d=this.data[b],e=a(d.selector).find("option[data-option='"+a(c).attr("data-number")+"']");if(a(e).attr("disabled",!0),a(e).attr("disabled","disabled"),a(c).addClass("tailms-disabled"),a(c).attr("data-disabled","true"),a(e).removeAttr("selected"),a(c).removeClass("tailms-selected"),a(c).attr("data-selected","false"),a(c).parent("ul").parent("li.tailms-optgroup").length>0){if(d.options.hide_disabled===!0)var f=a(c).parent("ul").children("li[data-selected='false'][data-disabled='false']").length;else var f=a(c).parent("ul").children("li[data-selected='false']").length;0==f&&a(c).parent("ul").parent(".tailms-optgroup").hide()}d.options.hide_disabled===!0&&a(c).hide(),this.action_empty(b),this.action_placeholder(b,c),a(d.selector).trigger("tailSelect:change",[a(c),"disabled",a(e)])}},c.prototype.action_empty=function(b){var c=this.data[b],d=c.objects.list;if(c.options.hide_disabled===!0)var e=a(d).find("li.tailms-option[disabled='true']").length;else var e=a(d).find("li.tailms-option").length;if(0===e){if(0==a(d).find("li.tailms-option-empty").length){var f=a("<li />",{"class":"tailms-option-empty"}).text(c.options.text_empty);a(d).append(f)}a(c.selector).trigger("tailSelect:empty")}else 0!=a(d).find("li.tailms-option-empty").length&&a(d).find("li.tailms-option-empty").remove()},c.prototype.action_placeholder=function(b,c){var d=this.data[b];if(d.options.multiple===!0){var e="",f=d.options.multi_limit,g=a(d.selector).find("option:selected").length;d.options.multi_show_count&&(e+="("+g,0!==f&&(e+="/"+f),e+=") "),0!==f&&g>=f?(e+=d.options.text_limit,a(d.objects.select).addClass("tailms-status-limit"),a(d.selector).trigger("tailSelect:limit",[g,f])):(e+=d.options.text_placeholder,a(d.objects.select).removeClass("tailms-status-limit")),a(d.objects.placeholder).text(e)}else a(d.objects.placeholder).text("true"===a(c).attr("data-selected")?a(c).children("span.tailms-option-label").text():d.options.text_placeholder)},c.prototype.action_remove=function(b){var c=this.data[b];return a(c.objects.select).remove(),a(c.selector).removeAttr(this.select),a(c.selector).show(),delete this.data[b],this.count--,!0},c.prototype.is_limit=function(b){var c=this.data[b];if(c.options.multiple===!1||0===c.options.multi_limit)return!1;var d=c.options.multi_limit,e=a(c.selector).find("option:selected").length;return e>=d?!0:!1},c.prototype.functions=function(b,c,d,e){if(-1==a.inArray(c,["enable","disable","open","close","register","reload","remove"]))return!1;if("register"===c){if("undefined"!==typeof a(b).attr(this.select))return!1;this.register(b,d)}var f=a(b).attr(this.select);if("undefined"===typeof f||this.data.hasOwnProperty(f)===!1)return!1;var g=this.data[f];if("open"===c||"close"===c)return this.change_status(f,c,!1),!0;if(("enable"===c||"disable"==c)&&("value"==d||"number"==d||"all"==d)&&("value"==d||"number"==d?"string"===typeof e&&(e=[e]):(d="number",e=[],a.each(a(g.objects.list).find("li.tailms-option"),function(b){e[b]=a(this).attr("data-number")})),a.isArray(e))){for(var h,i=0;i<e.length;i++)"value"==d&&e[i].replace(/"/g,"").replace(/'/g,""),h=a(g.objects.list).find("li.tailms-option[data-"+d+"='"+e[i]+"']"),"undefined"!==typeof h&&("enable"==c&&this.action_enable(f,h),"disable"==c&&this.action_disable(f,h));return!0}if("remove"===c)return this.action_remove(f),!0;if("reload"===c){var h=a.extend({},g.options);return this.action_remove(f),this.register(b,h)}return!1},a=jQuery,a.fn.extend({tailSelect:function(d,e,f){var g,h;return this.length>1&&(g={}),this.each(function(i){"undefined"==typeof b&&(b=new c),h="undefined"==typeof d||"object"==typeof d?b.register(this,d):a.inArray(d,["enable","disable","open","close","register","reload","remove"])>-1?b.functions(this,d,e,f):!1,"object"==typeof g?g["element_"+i]=h:g=h,a(this).trigger("tailSelect:ready")}),g}})}).call(this);